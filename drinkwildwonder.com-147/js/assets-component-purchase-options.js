if(!customElements.get("lg-purchase-options")){class LgPurchaseOptions extends HTMLElement{constructor(){super(),this.form=this.closest("form"),this.template=document.body.dataset.template,this.querySelectorAll(".js-purchase-option").forEach(el=>el.addEventListener("change",this.handlePurchaseOption.bind(this))),this.form.querySelectorAll('[name="quantity"]').forEach(el=>el.addEventListener("change",this.handleQuantityChange.bind(this))),this.oneTimePrices=this.form.querySelectorAll(".js-onetime-price"),this.recurringPrices=this.form.querySelectorAll(".js-autodeliver-price"),this.currentVariant=JSON.parse(this.form.querySelector("[data-current-variant-json]").textContent),this.giftCheckbox=this.querySelector(".js-is-gift"),this.giftForm=this.querySelector(".js-gift-form"),this.giftEmailInput=this.querySelector(".js-gift-email"),this.giftEmail=""}connectedCallback(){this.giftCheckbox&&this.giftCheckbox.addEventListener("input",this.handleGiftCheckbox.bind(this)),this.giftEmailInput&&this.giftEmailInput.addEventListener("input",this.handleEmailInput.bind(this))}validateEmail(email){return String(email).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}handlePurchaseOption(event){const purchaseType=event.target.value;purchaseType==="onetime"?(this.querySelector(".js-product-selling-plan").removeAttribute("name"),this.template!=="product"&&this.recurringPrices.forEach(el=>{el.classList.add("hide")})):(this.querySelector(".js-product-selling-plan").setAttribute("name","selling_plan"),this.template!=="product"&&this.recurringPrices.forEach(el=>{el.classList.remove("hide")})),document.querySelector("[data-add-to-cart]").setAttribute("data-purchase-type",purchaseType),this.querySelectorAll(".rc_block__type").forEach(el=>{el.classList.contains(`rc_block__type__${purchaseType}`)?el.classList.add("rc_block__type--active"):el.classList.remove("rc_block__type--active")})}handleQuantityChange(event){const quantity=parseInt(event.target.value);this.oneTimePrices.forEach(el=>{el.innerHTML=theme.Currency.formatMoney(this.currentVariant.price*quantity)});const sellingPlanId=this.querySelector('[name="selling_plan"]')?.value;if(!sellingPlanId)return;const sellingPlan=this.currentVariant.selling_plan_allocations.find(e=>e.selling_plan_id===+sellingPlanId);sellingPlan&&this.recurringPrices.forEach(el=>{el.innerHTML=theme.Currency.formatMoney(sellingPlan.price*quantity)})}handleGiftCheckbox(event){event.target.checked?(this.giftForm.classList.add("active"),this.querySelectorAll(".js-gift-input").forEach(input=>input.removeAttribute("disabled")),this.validateEmailInput()):(this.giftForm.classList.remove("active"),this.querySelectorAll(".js-gift-input").forEach(input=>input.setAttribute("disabled",!0)),this.form.querySelector("[data-add-to-cart]").removeAttribute("disabled"))}handleEmailInput(event){this.giftEmail=event.target.value,this.validateEmailInput()}validateEmailInput(){this.validateEmail(this.giftEmail)?this.form.querySelector("[data-add-to-cart]").removeAttribute("disabled"):this.form.querySelector("[data-add-to-cart]").setAttribute("disabled",!0)}}customElements.define("lg-purchase-options",LgPurchaseOptions)}
//# sourceMappingURL=/cdn/shop/t/58/assets/component-purchase-options.js.map?v=114339168301279739701737144660
